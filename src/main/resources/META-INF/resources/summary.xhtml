<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition
    xmlns:ui="jakarta.faces.facelets"
    xmlns:f="jakarta.faces.core"
    xmlns:h="jakarta.faces.html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:c="improve.persapiens.org"
    xmlns:d="jakarta.faces.composite/improve"
    xmlns:fn="jakarta.tags.functions"
    template="/layout/template.xhtml">
    <ui:define name="content" >
        <c:crud titleText="Recommendations that you should apply to your course."
                titleStyleClass="recommendation"                
                titleIcon="#{resource['images/ok.png']}"
                managedBean="#{recommendationFeedbackSummaryCrudMBean}"
                showInsert="false"
                showUpdateActionLink="false"
                dataTableLazy="false"
                showActionLinksColumn="true">
            <ui:define name="listColumns">
                <c:columnMainIdea field="recommendation.mainIdea" />

                <c:columnInterviews field="recommendation.recommendationInterviews.size()"
                                             style="width: 110px;"
                                             sortable="true"
                                             filterable="false" />

                <c:columnLinks field="recommendation.links.size()"
                                        style="width: 110px;"
                                        sortable="true"
                                        filterable="false" />

                <c:columnTheme field="recommendation.theme" 
                                        value="#{bean.recommendation.theme.value}"
                                        sortable="true" 
                                        filterable="false"/>

            </ui:define>
            
            <ui:define name="detail">
                <d:recommendationDetail crudMBean="#{recommendationFeedbackSummaryCrudMBean}" />

                <h:panelGrid columns="2" cellpadding="3">
                    <c:label label="Used Already Comment" />
                    <h:outputText id="usedAlreadyComment" value="#{fn:replace(recommendationFeedbackSummaryCrudMBean.bean.usedAlreadyComment, '\\n', '&lt;br/&gt;')}" escape="false" />

                    <c:label label="Will Use Comment" />
                    <h:outputText id="willUseComment" value="#{fn:replace(recommendationFeedbackSummaryCrudMBean.bean.willUseComment, '\\n', '&lt;br/&gt;')}" escape="false" />
                </h:panelGrid>

                <p:accordionPanel multiple="true" activeIndex="0" id="linkChallengeFeedbackAccordionPanel">
                    <p:tab title="Challenge Links (#{recommendationFeedbackSummaryCrudMBean.bean.recommendation.links.size()})"
                           titleStyleClass="challenge"
                           titletip="Show / hide the list of linked challenges">
                        <p:dataTable id="linkDatatable"
                                     widgetVar="linkDatatable"
                                     value="#{recommendationFeedbackSummaryCrudMBean.bean.recommendation.linkSortedByChallengeChallengeInterviewsSizeList}"
                                     var="link"
                                     emptyMessage="Sem Registros"
                                     rows="5"
                                     paginator="true"
                                     rowsPerPageTemplate="5,10,20,50"
                                     paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} {CurrentPageReport}"
                                     paginatorPosition="bottom"
                                     stripedRows="true"
                                     rowIndexVar="rowIdx"
                                     >
                            
                            <c:columnMainIdea field="challenge.mainIdea" />

                            <c:columnInterviews field="challenge.challengeInterviews.size()"
                                                         style="width: 110px;"
                                                         sortable="true"
                                                         filterable="false" />

                            <c:columnLinks field="challenge.links.size()"
                                                    style="width: 170px;"
                                                    sortable="true"
                                                    filterable="false" />

                            <c:columnTheme field="challenge.theme" 
                                                    value="#{link.challenge.theme.value}"
                                                    sortable="true" 
                                                    filterable="false"/>

                        </p:dataTable>
                    </p:tab>
                </p:accordionPanel>
            </ui:define>
        </c:crud>
        
        
        <c:crud crudId="challenge"
                titleText="Challenges that you will mitigate, but you use no linked recommendation."
                titleStyleClass="challenge"
                titleIcon="#{resource['images/warning.png']}" 
                managedBean="#{challengeFeedbackSummaryCrudMBean}"
                showInsert="false"
                showUpdateActionLink="false"
                dataTableLazy="false"
                showActionLinksColumn="true">
            <ui:define name="listColumns">
                <c:columnMainIdea field="challenge.mainIdea" />

                <c:columnInterviews field="challenge.challengeInterviews.size()"
                                             style="width: 110px;"
                                             sortable="true"
                                             filterable="false" />

                <c:columnLinks field="challenge.links.size()"
                                        style="width: 170px;"
                                        sortable="true"
                                        filterable="false" />

                <c:columnTheme field="challenge.theme" 
                                        value="#{bean.challenge.theme.value}"
                                        sortable="true" 
                                        filterable="false"/>
            </ui:define>
            
            <ui:define name="detail">
                <d:challengeDetail crudMBean="#{challengeFeedbackSummaryCrudMBean}" />
                
                <h:panelGrid columns="2" cellpadding="3">
                    <c:label id="willMitigateCommentChallenge" label="Will Mitigate Comment" />
                    <h:outputText value="#{fn:replace(challengeFeedbackSummaryCrudMBean.bean.willMitigateComment, '\\n', '&lt;br/&gt;')}" escape="false" />
                </h:panelGrid>

                <p:accordionPanel multiple="true" activeIndex="0" id="linkRecommendationFeedbackAccordionPanel">
                    <p:tab title="Recommendation Links (#{challengeFeedbackSummaryCrudMBean.bean.challenge.links.size()})"
                           titleStyleClass="recommendation"
                           titletip="Show / hide the list of linked recommendations">
                        <p:dataTable id="linkDatatable"
                                     widgetVar="linkDatatable"
                                     value="#{challengeFeedbackSummaryCrudMBean.bean.challenge.linkSortedByRecommendationRecommendationInterviewsSizeList}"
                                     var="link"
                                     emptyMessage="Sem Registros"
                                     rows="5"
                                     paginator="true"
                                     rowsPerPageTemplate="5,10,20,50"
                                     paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} {CurrentPageReport}"
                                     paginatorPosition="bottom"
                                     stripedRows="true"
                                     rowIndexVar="rowIdx"
                                     >
                            
                            <c:columnMainIdea field="recommendation.mainIdea" />

                            <c:columnInterviews field="recommendation.recommendationInterviews.size()"
                                                         style="width: 110px;"
                                                         sortable="true"
                                                         filterable="false" />

                            <c:columnLinks field="recommendation.links.size()"
                                                    style="width: 110px;"
                                                    sortable="true"
                                                    filterable="false" />

                            <c:columnTheme field="recommendation.theme" 
                                                    value="#{link.recommendation.theme.value}"
                                                    sortable="true" 
                                                    filterable="false"/>

                        </p:dataTable>
                    </p:tab>
                </p:accordionPanel>
            </ui:define>
        </c:crud>
        
    </ui:define>
</ui:composition>
